import{p as e,d as t,b as a,j as s,q as l,l as o,c as n,e as c,o as r,f as d,g as i,t as u,A as m,i as p,B as f,m as v,v as h,w as y,F as _,z as I,n as g,h as w,r as b,k as x,u as C}from"./index.f8f7fc4f.js";import{r as $,h as T}from"./toolFun.fa8e1713.js";import"./vendor.521ca53b.js";const k={name:"commentItem",props:{data:{type:Object}},components:{},setup(e,t){const{proxy:c}=g(),r=a();let d=e.data,i=s(!1),u=l("success");var m=c;o((()=>{document.addEventListener("click",(e=>{1==i.value&&(m.$refs.input.contains(e.target)||(i.value=!1))}))}));let p=s("");return{item:d,replay:p,show:i,upComment:function(){let e=d._id,t=e;null!=d.follow&&(t=d.follow),c.$axios.post("addComment",{articleId:d.articleId,content:p.value,user:r.state.userInfo._id,commentId:e,follow:t}).then((e=>{200==e.code&&(p.value="",i.value=!1,u(),n.success({message:e.msg}))}))}}}},E=w("data-v-e58e7c60");e("data-v-e58e7c60");const V={class:"header"},j={class:"right"},A={key:0,class:"replayCont"},K={class:"bottom_comment"},U={class:"time"},q=i("img",{src:"/assets/comment.ff7f8d59.png",class:"btnIcon",alt:""},null,-1),L=p(" 回复 "),P={class:"replay",ref:"input"},F={class:"children"};t();const H=E(((e,t,a,s,l,o)=>{const n=c("el-input"),g=c("_self");return r(),d("div",null,[i("div",V,[i("img",{class:"userAvator",src:s.item.user.picUrl,alt:"",srcset:""},null,8,["src"]),i("div",j,[i("p",null,u(s.item.user.username),1),i("p",null,[s.item.replay?(r(),d("span",A,u("回复 "+s.item.replay+":"),1)):m("",!0),p(u(s.item.content),1)])])]),i("div",K,[i("div",U,u(s.item.howTime),1),i("div",{class:"huifu",onClick:t[1]||(t[1]=f((e=>s.show=!s.show),["stop"]))},[q,L])]),i("div",P,[v(i(n,{placeholder:"回复"+s.item.user.username+"...",onKeyup:y(s.upComment,["enter"]),modelValue:s.replay,"onUpdate:modelValue":t[2]||(t[2]=e=>s.replay=e)},null,8,["placeholder","onKeyup","modelValue"]),[[h,s.show]])],512),i("div",F,[(r(!0),d(_,null,I(s.item.children,(e=>(r(),d(g,{key:e._id,data:e},null,8,["data"])))),128))])])}));k.render=H,k.__scopeId="data-v-e58e7c60";const M={components:{commentItem:k},setup(){let e=l("_id");const t=a(),o=t.state.userInfo,{proxy:c}=g(),r=s("");let d=b([]);function i(){c.$axios.get(`/getComment?articleId=${e}`).then((e=>{if(200==e.code){e.data.forEach((t=>{if(t.updatedTime=$(t.updatedTime),t.howTime=T(t.updatedTime),null!=t.follow||null!=t.follow){let a=e.data.filter((e=>e._id==t.commentId));t.replay=a[0].user.username}})),e.data.filter((e=>null==e.follow)).forEach((t=>{if(t.children=e.data.filter((e=>e.follow==t._id)),!t.follow){let e=!0;d.forEach((a=>{t._id==a._id&&(e=!1)})),e&&d.push(t)}})),d.forEach((t=>{t.children||(t.children=[]),e.data.forEach((e=>{t._id==e.follow&&t.children.indexOf(e)<0&&t.children.push(e)}))}))}}))}function u(e){i()}return i(),x("success",u),{userInfo:o,comment:r,upComment:function(){c.$axios.post("addComment",{articleId:e,content:r.value,user:t.state.userInfo._id,follow:null}).then((e=>{200==e.code&&(r.value="",n.success({message:e.msg}),i())}))},comments:d,success:u}}},O=w("data-v-636a3d17");e("data-v-636a3d17");const z={class:"commentArticle"},B={class:"comments"};t();const D=O(((e,t,a,s,l,o)=>{const n=c("el-input"),u=c("comment-item");return r(),d("div",null,[i("div",z,[i("img",{class:"userAvator",src:e.$store.state.userInfo.picUrl,alt:"",srcset:""},null,8,["src"]),i(n,{placeholder:"输入评论...",onKeyup:y(s.upComment,["enter"]),modelValue:s.comment,"onUpdate:modelValue":t[1]||(t[1]=e=>s.comment=e)},null,8,["onKeyup","modelValue"])]),i("div",B,[(r(!0),d(_,null,I(s.comments,(e=>(r(),d("div",{key:e._id,class:"comment"},[i(u,{success:s.success,data:e},null,8,["success","data"])])))),128))])])}));M.render=D,M.__scopeId="data-v-636a3d17";const G={components:{artComment:M},setup(){const e=C(),t=e.query.id,{proxy:a}=g();let s=b({title:"",introduce:"",coverPic:"",content:""});return x("_id",t),e.query.id&&a.$axios.get(`/article/${t}`).then((e=>{200==e.code&&(s.title=e.data.title,s.introduce=e.data.introduce,s.coverPic=e.data.coverImg,s.content=e.data.content)})),{article:s}}},J=w("data-v-6b8b603a");e("data-v-6b8b603a");const N={class:"article"},Q={class:"instroduce"};t();const R=J(((e,t,a,s,l,o)=>{const n=c("art-comment");return r(),d("div",N,[i("h2",null,u(s.article.title),1),i("p",Q,u(s.article.introduce),1),i("img",{src:s.article.coverPic,alt:"",class:"coverImg"},null,8,["src"]),i("div",{innerHTML:s.article.content},null,8,["innerHTML"]),i(n)])}));G.render=R,G.__scopeId="data-v-6b8b603a";export default G;
